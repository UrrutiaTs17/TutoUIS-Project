<!-- Admin Tutorías - Gestión de Tutorías -->
<div class="admin-tutorias-container">
  <!-- Header -->
  <div class="section-header mb-4">
    <h2 class="mb-0">
      <i class="bi bi-book-half me-2"></i> Gestión de Tutorías
    </h2>
  </div>

  <!-- Mensajes de Estado -->
  <div *ngIf="error" class="alert alert-danger alert-dismissible fade show" role="alert">
    <i class="bi bi-exclamation-circle me-2"></i>
    {{ error }}
    <button type="button" class="btn-close" (click)="error = ''" aria-label="Cerrar"></button>
  </div>

  <div *ngIf="successMessage" class="alert alert-success alert-dismissible fade show" role="alert">
    <i class="bi bi-check-circle me-2"></i>
    {{ successMessage }}
  </div>

  <!-- Barra de Búsqueda y Filtros -->
  <div class="search-bar mb-4">
    <div class="row g-3">
      <div class="col-md-6">
        <div class="input-group">
          <span class="input-group-text bg-white">
            <i class="bi bi-search"></i>
          </span>
          <input 
            type="text" 
            class="form-control" 
            placeholder="Buscar por nombre..." 
            [(ngModel)]="searchTerm"
            (input)="onSearchChange()">
        </div>
      </div>
      <div class="col-md-3">
        <input 
          type="text" 
          class="form-control" 
          placeholder="Filtrar por tutor..." 
          [(ngModel)]="filterTutor"
          (input)="aplicarFiltros()">
      </div>
      <div class="col-md-3">
        <input 
          type="text" 
          class="form-control" 
          placeholder="Filtrar por carrera..." 
          [(ngModel)]="filterCarrera"
          (input)="aplicarFiltros()">
      </div>
    </div>
  </div>

  <!-- Botones de Acción -->
  <div class="action-buttons mb-3">
    <button 
      class="btn btn-primary me-2"
      (click)="abrirModalCrear()">
      <i class="bi bi-plus-circle me-2"></i> Crear Nueva Tutoría
    </button>
    <button 
      class="btn btn-secondary"
      (click)="cargarTutorias()">
      <i class="bi bi-arrow-clockwise me-2"></i> Recargar
    </button>
  </div>

  <!-- Spinner de Carga -->
  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
    <p class="mt-2 text-muted">Cargando tutorías...</p>
  </div>

  <!-- Tabla de Tutorías -->
  <div *ngIf="!loading && !error" class="table-responsive">
    <table class="table table-hover table-striped">
      <thead class="table-dark">
        <tr>
          <th>ID</th>
          <th>Asignatura</th>
          <th>Descripción</th>
          <th>Tutor</th>
          <th>Carrera</th>
          <th>Capacidad</th>
          <th>Ubicación</th>
          <th>Estado</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let tutoria of tutoriasFiltradas">
          <td class="text-muted small">{{ tutoria.idTutoria }}</td>
          <td class="fw-bold">{{ tutoria.nombreAsignatura }}</td>
          <td>{{ tutoria.descripcion || 'N/A' }}</td>
          <td>{{ tutoria.nombreTutor }}</td>
          <td>{{ tutoria.nombreCarrera }}</td>
          <td class="text-center">{{ tutoria.capacidadMaxima }}</td>
          <td>{{ tutoria.ubicacion || 'N/A' }}</td>
          <td>
            <span [ngClass]="getClaseEstado(tutoria.estado)">
              {{ getNombreEstado(tutoria.estado) }}
            </span>
          </td>
          <td>
            <button 
              class="btn btn-sm btn-warning me-2"
              title="Editar"
              disabled>
              <i class="bi bi-pencil"></i>
            </button>
            <button 
              class="btn btn-sm btn-danger"
              title="Eliminar"
              (click)="eliminarTutoria(tutoria.idTutoria, tutoria.nombreAsignatura || tutoria.descripcion || 'Tutoría')">
              <i class="bi bi-trash"></i>
            </button>
          </td>
        </tr>
        <tr *ngIf="tutoriasFiltradas.length === 0 && !loading">
          <td colspan="9" class="text-center text-muted py-4">
            <i class="bi bi-inbox"></i> No hay tutorías disponibles
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Información -->
  <div *ngIf="!loading && tutoriasFiltradas.length > 0" class="mt-3 text-muted small">
    <i class="bi bi-info-circle me-1"></i>
    Mostrando {{ tutoriasFiltradas.length }} de {{ tutorias.length }} tutorías
  </div>
</div>

<!-- Modal para Crear Tutoría -->
<app-create-tutoria-modal 
  #createModal
  (tutoriaCreated)="onTutoriaCreated($event)">
</app-create-tutoria-modal>
