<!-- Admin Tutorías - Gestión de Tutorías -->
<div class="admin-tutorias-container">
  <!-- Header -->
  <div class="section-header mb-4">
    <h2 class="mb-0">
      <i class="bi bi-book-half me-2"></i> Gestión de Tutorías
    </h2>
  </div>

  <!-- Mensajes de Estado -->
  <div *ngIf="error" class="alert alert-danger alert-dismissible fade show" role="alert">
    <i class="bi bi-exclamation-circle me-2"></i>
    {{ error }}
    <button type="button" class="btn-close" (click)="error = ''" aria-label="Cerrar"></button>
  </div>

  <div *ngIf="successMessage" class="alert alert-success alert-dismissible fade show" role="alert">
    <i class="bi bi-check-circle me-2"></i>
    {{ successMessage }}
  </div>

  <!-- Barra de Búsqueda y Filtros -->
  <div class="search-bar mb-4">
    <div class="row g-3">
      <div class="col-md-6">
        <div class="input-group">
          <span class="input-group-text bg-white">
            <i class="bi bi-search"></i>
          </span>
          <input 
            type="text" 
            class="form-control" 
            placeholder="Buscar por nombre..." 
            [(ngModel)]="searchTerm"
            (input)="onSearchChange()">
        </div>
      </div>
      <div class="col-md-3">
        <input 
          type="text" 
          class="form-control" 
          placeholder="Filtrar por tutor..." 
          [(ngModel)]="filterTutor"
          (input)="aplicarFiltros()">
      </div>
      <div class="col-md-3">
        <input 
          type="text" 
          class="form-control" 
          placeholder="Filtrar por carrera..." 
          [(ngModel)]="filterCarrera"
          (input)="aplicarFiltros()">
      </div>
    </div>
  </div>

  <!-- Botones de Acción -->
  <div class="action-buttons mb-3">
    <button 
      class="btn btn-primary me-2"
      (click)="abrirModalCrear()">
      <i class="bi bi-plus-circle me-2"></i> Crear Nueva Tutoría
    </button>
    <button 
      class="btn btn-secondary"
      (click)="cargarTutorias()">
      <i class="bi bi-arrow-clockwise me-2"></i> Recargar
    </button>
  </div>

  <!-- Spinner de Carga -->
  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
    <p class="mt-2 text-muted">Cargando tutorías...</p>
  </div>

  <!-- Lista de Tutorías -->
  <div *ngIf="!loading && !error" class="tutorias-list">
    <div class="tutoria-item" *ngFor="let tutoria of tutoriasFiltradas">
      <div class="tutoria-content">
        <div class="tutoria-main">
          <div class="tutoria-title">
            <span class="tutoria-id">#{{ tutoria.idTutoria }}</span>
            <h4>{{ tutoria.nombreAsignatura }}</h4>
            <span class="estado-badge" [ngClass]="getClaseEstadoTutoria(tutoria)" 
                  [title]="tutoria.descripcionEstadoTutoria || ''">
              {{ getNombreEstadoTutoria(tutoria) }}
            </span>
          </div>
          <p class="tutoria-descripcion">{{ tutoria.descripcion || 'Sin descripción' }}</p>
        </div>
        
        <div class="tutoria-details">
          <div class="detail-item">
            <i class="bi bi-person-circle"></i>
            <span>{{ tutoria.nombreTutor }}</span>
          </div>
          <div class="detail-item">
            <i class="bi bi-mortarboard-fill"></i>
            <span>{{ tutoria.nombreCarrera }}</span>
          </div>
          <div class="detail-item" *ngIf="tutoria.ubicacion">
            <i class="bi bi-geo-alt-fill"></i>
            <span>{{ tutoria.ubicacion }}</span>
          </div>
        </div>
      </div>
      
      <div class="tutoria-actions">
        <button 
          class="btn btn-outline-success btn-sm me-1"
          title="Editar tutoría"
          (click)="editarTutoria(tutoria)">
          <i class="bi bi-pencil-fill me-1"></i>Editar
        </button>
        <button 
          class="btn btn-outline-danger btn-sm"
          title="Eliminar tutoría"
          (click)="eliminarTutoria(tutoria.idTutoria, tutoria.nombreAsignatura || 'Tutoría')">
          <i class="bi bi-trash-fill me-1"></i>Eliminar
        </button>
      </div>
    </div>

    <!-- Mensaje cuando no hay tutorías -->
    <div *ngIf="tutoriasFiltradas.length === 0" class="text-center py-5 text-muted">
      <i class="bi bi-inbox" style="font-size: 3rem;"></i>
      <p class="mt-3">No hay tutorías disponibles</p>
    </div>
  </div>

  <!-- Información -->
  <div *ngIf="!loading && tutoriasFiltradas.length > 0" class="mt-3 text-muted small">
    <i class="bi bi-info-circle me-1"></i>
    Mostrando {{ tutoriasFiltradas.length }} de {{ tutorias.length }} tutorías
  </div>
</div>

<!-- Modal para Crear Tutoría -->
<app-create-tutoria-modal 
  #createModal
  (tutoriaCreated)="onTutoriaCreated($event)">
</app-create-tutoria-modal>

<!-- Modal para Editar Tutoría -->
<app-edit-tutoria-modal 
  #editModal
  (tutoriaUpdated)="onTutoriaCreated($event)">
</app-edit-tutoria-modal>
