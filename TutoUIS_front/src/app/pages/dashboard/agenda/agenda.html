<div class="agenda-container py-4">
	<div class="agenda-inner container">
		<div class="row g-4">
			<div class="col-lg-8">
				<!-- Reuse existing calendar component -->
				<app-calendar></app-calendar>
			</div>

			<aside class="col-lg-4">
				<div class="card recent-card">
					<div class="card-header d-flex justify-content-between align-items-center">
						<h3 class="mb-0">Reservas recientes</h3>
						<small class="text-muted">Últimas {{ reservations.length || 0 }}</small>
					</div>
					<div class="card-body p-0">
						<ul class="list-group list-group-flush">
							<li *ngIf="loading" class="list-group-item text-center py-4">
								Cargando reservas...
							</li>
							<li *ngIf="error" class="list-group-item text-danger">
								{{ error }}
							</li>
							  <li *ngFor="let r of pagedReservations; trackBy: trackReservation" class="list-group-item">
								<div class="d-flex w-100 justify-content-between align-items-start">
									<div>
										<h5 class="mb-1 reservation-title">{{ r.materia || r.asignatura || r.nombre }}</h5>
										<p class="mb-0 small text-muted">{{ r.detalle || (r.docente ? r.docente : '') }}</p>
															<p class="mb-0 small text-secondary">{{ r.fecha ? (r.fecha) : (r.dia || '') }} · {{ r.hora || r.horario }}</p>
									</div>
									<div class="ms-3 text-end">
										<span class="badge bg-success-subtle text-success">Cupos: {{ r.cupos || r.cuposDisponibles || r.cupos_actuales || '-' }}</span>
									</div>
								</div>
							</li>
							<li *ngIf="!loading && reservations.length === 0" class="list-group-item text-muted">
								No hay reservas recientes.
							</li>
						</ul>
					</div>
					<div class="card-footer d-flex justify-content-between align-items-center">
						<div>
							<button class="btn btn-sm btn-outline-secondary me-2" (click)="prevPage()" [disabled]="currentPage === 0">Anterior</button>
							<button class="btn btn-sm btn-outline-secondary" (click)="nextPage()" [disabled]="(currentPage+1)*pageSize >= reservations.length">Siguiente</button>
						</div>
						<small class="text-muted">Página {{ currentPage + 1 }} / {{ Math.max(1, Math.ceil(reservations.length / pageSize)) }}</small>
					</div>
				</div>
			</aside>
		</div>
	</div>
</div>
